{"version":3,"sources":["../src/libs/auth.ts"],"names":[],"mappings":";;AAAA,oCAAoC;AACpC,mCAAmC;AACnC,MAAM,UAAU,GAAG,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC;AAEzC,KAAK,iBAAiB,KAAK;IACvB,IAAI,CAAC;QACD,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACT,MAAM,CAAC;gBACH,KAAK,EAAE,eAAe;aACzB,CAAC;QACN,CAAC;QACD,IAAI,YAAY,GAAG,MAAM,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;QAEvD,MAAM,CAAC,YAAY,CAAC;IACxB,CAAC;IAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACT,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QACf,MAAM,CAAC;YACH,KAAK,EAAE,CAAC,CAAC,OAAO;SACnB,CAAC;IACN,CAAC;AACL,CAAC;AAED,KAAK,sBAAsB,GAAG;IAC1B,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC;IAC5B,IAAI,OAAO,mBACP,GAAG,EAAE,GAAG,GAAG,KAAK,EAChB,GAAG,EAAE,GAAG,EACR,GAAG,EAAE,iBAAiB,IACnB,GAAG,CACT,CAAC;IAEF,IAAI,KAAK,GAAG,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;IAE1C,MAAM,CAAC,EAAC,KAAK,EAAE,OAAO,EAAC,CAAC;AAC5B,CAAC;AAED,kBAAe;IACX,MAAM;IACN,WAAW;CACd,CAAC","file":"auth.js","sourcesContent":["import * as jwt from 'jsonwebtoken';\r\nimport * as config from \"./config\";\r\nconst JWT_SECRET = config.app.jwt_secret;\r\n\r\nasync function verify(token) {\r\n    try {\r\n        if (!token) {\r\n            return {\r\n                error: \"missing_token\"\r\n            };\r\n        }\r\n        let verifyResult = await jwt.verify(token, JWT_SECRET);\r\n\r\n        return verifyResult;\r\n    } catch (e) {\r\n        console.log(e);\r\n        return {\r\n            error: e.message\r\n        };\r\n    }\r\n}\r\n\r\nasync function createToken(obj) {\r\n    let NOW = Date.now() / 1000;\r\n    let payload = {\r\n        exp: NOW + 86400,\r\n        iat: NOW,\r\n        iss: \"eye-solution.vn\",\r\n        ...obj\r\n    };\r\n\r\n    let token = jwt.sign(payload, JWT_SECRET);\r\n\r\n    return {token, payload};\r\n}\r\n\r\nexport default {\r\n    verify,\r\n    createToken\r\n};"]}